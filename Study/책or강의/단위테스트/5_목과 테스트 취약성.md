# 목과 테스트 취약성
=> 리펙터링 내성이 부족한 테스트

> - 목과 스텁 구분
> - 식별할 수 있는 동작과 구현 세부 사항 정의
> - 목과 테스트 취약성 간의 관계 이해
> - 리팩터링 내성 저하 없이 목 사용하기

|-|런던파|고전파|
|------|---|---|
|테스트<br/>격리문제|테스트 대상 코드 조각을 서로 분리,<br/>불변 의존성을 제외한 모든 의존성에서 테스트 대역을 써서 격리|단위 테스트를 분리해서 병렬로 실행.<br/>테스트간에 <u>공유하는 의존성</u>에 대해서만 테스트 대역 사용|

## 목과 스텁 구분
목은 <u>테스트 대상 시스템</u>과 그 <u>협력자</u> 사이의 ==상호작용==을 검사할수 있는 테스트 대역.
테스트 대역에 또 다른 유형이 있는데, 바로 스텁이다.

### 5.1.1 테스트 대역 유형
>**테스트 대역**
>모든 유형의 비 운영용 가짜 의존성을 설명하는 포괄적 용어
>주 용도: <u>테스트를 편리하게</u> 하는것.

제라드 메스자로스에 따르면 목, 스파이, 스터, 더미, 페이크 라는 다섯가지 유형이 있다.
하지만 실제로 목과 스텁 두가지 유형으로 나눌 수 있다.
![[mock_stub.jpg]]
- 목(목, 스파이)
	- 외부로 나가는 상호 작용을 모방하고 검사하는데 도움.
	- 상호작용은 SUT가 상태를 변경하기 위한 의존성을 호출하는 것에 해당한다.
	- 스파이는 과 같은 역할을 한다.
		- 스파이는 수동으로 작성하는 반면, 목은 목 프레임워크의 도움을 받아 생성된다. 가끔 직접 작성한 목(handwritten mock)이라고 부르기도 한다.
- 스텁(스텁, 더미, 페이크)
	- 내부로 들어오는 상호작용을 모방하는데 도움
	- SUT가 입력 데이터를 위한 의존성을 호출하는데 해당한다.
	- 스텁, 더미, 페이크의 차이는 얼마나 똑똑한지에 있다.
		- 더미는 null값이나 가짜 문자열과 같이 단순하고 하드코딩된 값이다. SUT의 매서드 시그니처를 만족시키기 위해 사용하고 최종 결과를 만드는데 영향을 주지 않는다.
		- 스텁은 더 정교하다. 시나리오마다 다른 값을 반환하게끔 구성할 수 있도록 필요한 것을 다 갖춘 완전한 의존성이다.
		- 페이크는 대다수의 목적에 부합하는 스텁과 같다. 페이크는 보통 아직 존재하지 않는 의존성을 대체하고자 구현한다.

> 목은 SUT와 관련 **의존성 간의 상호 작용을 모방하고 검사**하는 반면, 
> **스텁은 모방만** 한다.

### 5.1.2 도구로서의 목과 테스트 대역으로서의 목
