[DB RDBMS의 한계와 NoSQL을 사용하는 이유 (1) CAP, PACELC 이론](https://sujl95.tistory.com/81)
---
분산 컴퓨팅 환경은 `일관성(Consistency)` , `가용성(Availability)`, `분할 내성(Partitioning)` 세가지 특징을 가지고 있다. CAP이론은 이 중 두가지만 만족할 수 있다는 이론이다. NoSQL대부분은 이 CAP이론을 따른다.

![CAP이론_삼각형](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FcGTlHX%2FbtrmhZ0Ag3f%2FPSkC9ybxFcqste7ab1AyE1%2Fimg.png)

## 일관성(Consistency)

- 모든 노드들이 동일 시간 동일 데이터를 사용자에게 보여줘야 하는것
	일관성은 동시성, 동일성이라고도 하며, 다중 클라이언트 환경에서 같은 시간에 조회하는 데이터는 항상 동일해야 한다는것을 보증하는것을 의미한다.
- ACID의 `C`는 항상 일관성 있는 상태를 유지해야 하고 데이터의 조작 후에도 무결성을 해치지 말아야 한다는 속성이다.
	- [?] Constistency보단 Atomic(원자성)이 더 맞는 특성을 나타낸다고 할 수 있다.
- 쓰기 동작이 완료된 후 발생하는 읽기 동작은 마지막으로 쓰여진 데이터를 리턴 해야한다.
> - RDBMS가 지원하는 가장 기본적인 기능이지만, 일관성을 지원하지 않는 NoSQL을 사용한다면 데이터의 일관성이 느슨하게 처리되어 동일한 데이터가 나타나지 않을 수 있다.
>> 느슨하게 처리된다 - 데이터의 변경을 시간의 흐름에 따라 여러 노드에 전파

## 가용성 (Availability)

- 특정 노드에 장애가 발생해도 성공적으로 서비스를 지속하는 것
- 데이터 저장소에 대한 모든 동작(read, write 등) 항상 성공적으로 반환되어야 한다.

## 분할 내성(Partition Tolerance)

- 파티션 허용, 분산화 가능 물리적 네트워크 분산 환경에서도 시스템이 잘 작동해야 만족
- Availability와 차이점은 가용성은 특정 노드 장애 상황에 대한 것이고 분할 내성은 노드 상태는 정상이지만, 네트워크 문제로 서로간의 연결이 끊긴 상황에 대한 것이다.

# DBMS 별 CAP

> CAP 이론에 따르면 분산 시스템은 이중 2가지만 만족 할 수 있다.

## RDBMS => CA

- [p] 일관성, 가용성
- [c] 분산화

> [!check] 즉, 시스템 신뢰성이 높다.
> 분산구조를 가져가는 것이 가능하지만, Replication(Master-Slave)의 경우 퍼포먼스를 고려해야 하고, Sharding(Partitioning)의 경우 데이터의 관계가 무너질 수 있는 부담감이 있다.
>> MySQL의 경우 Master-Slave관계를 사용할 때 `CA`를, 클러스터 구성을 할 때 `CP`를 만족한다.
>
>클러스터 구성을 한다면 라이브 노드 개수가 적을 때 클러스터가 종료될 수 있다.

## NoSQL은 CP, AP의 형태를 가질 수 있다.

>[!check] 데이터의 신뢰성 보다는 분산에 중점을 둔 방식
>약간의 데이터의 유실, 변형 등이 발생할 수 있다.
>하지만 빠르게 확장을 하여 대규모 데이터를 저장하고 핸들링 할 수 있는 구조를 갖추도록 한다.
>기존 RDBMS에 없는 특징을 가져가는 대신, C나 A하나를 포기해야 한다.

- **CP를 가지는 형태**: MongoDB, Redis
- **AP를 가지는 형태**: DynamoDB, cassandra, CouchDB
  일관성을 포기하여 **데이터의 동기화를 보장하지 못하지만**, *비동기화된 대용량 데이터 처리에 유리할 수 있다*.

- [p] 여러 DB에서 다양한 조합을 살펴보고 CAP 우선순위를 정하여 선택하는 것이 좋다.




